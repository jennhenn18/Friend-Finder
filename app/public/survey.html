<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FriendFinder</title>

    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Shadows+Into+Light&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
    
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
    
    <!-- Header -->

        <h1 id="surveyTitle">Let's begin!</h1>

    <!-- Begin Questions -->

            <!-- Question 1 -->
            <h3 class="text">Would you rather...</h3>

                <div class="question" id="question-1">
                    <input type="radio" name="question1" value="1" id="option1-1">
                            <label for="option1-1">Date your sister's stalker?</label> 
                    <input type="radio" name="question1" value="2" id="option1-2">
                            <label for="option1-2">Or date your stalker?</label>


            <!-- Question 2 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-2">
                <input type="radio" name="question2" value="1" id="option2-1">
                        <label for="option2-1">Leave someone at the altar?</label> 
                <input type="radio" name="question2" value="2" id="option2-2">
                        <label for="option2-2">Or say the wrong name at the altar?</label>

            <!-- Question 3 -->
            <h3 class="text">Would you rather...</h3>
           
            <div class="question" id="question-3">
                <input type="radio" name="question3" value="1" id="option3-1">
                        <label for="option3-1">Ask a friend to pee on your leg to numb a jellyfish sting?</label> 
                <input type="radio" name="question3" value="2" id="option3-2">
                        <label for="option3-2">Or pee on your friend to numb a jellyfish sting?</label>

            <!-- Question 4 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-4">
                <input type="radio" name="question4" value="1" id="option4-1">
                        <label for="option4-1">Bet giving up your pets?</label> 
                <input type="radio" name="question4" value="2" id="option4-2">
                        <label for="option4-2">Or bet giving up your apartment?</label>

            <!-- Question 5 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-5">
                <input type="radio" name="question5" value="1" id="option5-1">
                        <label for="option5-1">Eat wax to wait out an awkard fight?</label> 
                <input type="radio" name="question5" value="2" id="option5-2">
                        <label for="option5-2">Or drink fat to end an argument?</label>

            <!-- Question 6 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-6">
                <input type="radio" name="question6" value="1" id="option6-1">
                        <label for="option6-1">Be in labor for 48 hours?</label> 
                <input type="radio" name="question6" value="2" id="option6-2">
                        <label for="option6-2">Or pass a kidney stone?</label>

            <!-- Question 7 -->
            <h3 class="text">Would you rather...</h3>

                
            <div class="question" id="question-7">
                <input type="radio" name="question7" value="1" id="option7-1">
                        <label for="option7-1">Spend a day alone with Eddie?</label> 
                <input type="radio" name="question7" value="2" id="option7-2">
                        <label for="option7-2">Or with Janice?</label>

            <!-- Question 8 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-8">
                <input type="radio" name="question8" value="1" id="option8-1">
                        <label for="option8-1">Own a pet monkey?</label> 
                <input type="radio" name="question8" value="2" id="option8-2">
                        <label for="option8-2">Or have a chick and a duck?</label>

            <!-- Question 9 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-9">
                <input type="radio" name="question9" value="1" id="option9-1">
                        <label for="option9-1">Learn how to sail?</label> 
                <input type="radio" name="question9" value="2" id="option9-2">
                        <label for="option9-2">Or learn how to play guitar?</label>


            <!-- Question 10 -->
            <h3 class="text">Would you rather...</h3>

            <div class="question" id="question-10">
                <input type="radio" name="question10" value="1" id="option10-1">
                        <label for="option10-1">Live in a clean apartment with an OCD roomate?</label> 
                <input type="radio" name="question10" value="2" id="option10-2">
                        <label for="option10-2">Or live in a fun apartment with a foosball table?</label>


                <button type="button" class="btn btn-primary btn-lg btn-block submit">Submit survey!</button>
        </form>
    </div>

    <!-- Modal window -->
    <div class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">You got <h5 id="matchName"></h5></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <p>
                  <img src="" id="matchImage">
            </div>
          </div>
        </div>
      </div>


    <!-- import Javascript files -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <script type='text/javascript'>

        // on click of submit button store all selected values
        $('.submit').on('click', (e) => {
                e.preventDefault();
        
                var answer1 = $('#question-1 [name=question1]:checked').val();
                var answer2 = $('#question-2 [name=question2]:checked').val();
                var answer3 = $('#question-3 [name=question3]:checked').val();
                var answer4 = $('#question-4 [name=question4]:checked').val();
                var answer5 = $('#question-5 [name=question5]:checked').val();
                var answer6 = $('#question-6 [name=question6]:checked').val();
                var answer7 = $('#question-7 [name=question7]:checked').val();
                var answer8 = $('#question-8 [name=question8]:checked').val();
                var answer9 = $('#question-9 [name=question9]:checked').val();
                var answer10 = $('#question-10 [name=question10]:checked').val();

                // store user answer as a string
                var userAnswerStr = answer1 + ',' + answer2  + ',' + answer3 + ',' + answer4 + ',' + answer5 + ',' + answer6 + ',' + answer7 + ',' + answer8 + ',' + answer9 + ',' + answer10;

                
                // change the string values into an array of numbers
                var userAnswerArray = userAnswerStr.split(',').map(Number)
                
                var userAnswer = {
                        userinput: userAnswerArray
                };

                // create POST AJAX call
                $.post('/api/survey', userAnswer, (data) => {
                        // if the call passes trigger the modal
                        if (data) {
                                // update the modal with the best match information
                                $('#matchName').html(data.name)
                                $('#matchImage').attr('src', data.image)
                                // trigger the modal
                                $('.modal').show();
                        } else {
                                // throw an error message
                                alert('Oh no! Something went wrong. Please try again.')
                        }
                // clear the form
                $('.question').val('');

                });
        }); 
    </script>

</body>
</html>